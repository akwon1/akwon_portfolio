# Load required packages (hint: you need tidycensus, tidyverse, and knitr)
install.packages("tidycensus")
install.packages("tidyverse")
install.packages("knitr")
library(tidycensus)
library(tidyverse)
library(knitr)
# Set your Census API key
census_api_key("eb283fc5f20283cf588e1f363afe8bc73cf9c354", install = TRUE)
# Set your Census API key
census_api_key("eb283fc5f20283cf588e1f363afe8bc73cf9c354", install = TRUE)
# Choose your state for analysis - assign it to a variable called my_state
my_state <- "Michigan"
# Write your get_acs() code here
acsVariables <- c(med_HH_inc = "B19013_001", totpop = "B01003_001")
MI_2022 <- get_acs(geography="county", variables = acsVariables,
state = "MI", survey = "acs5", year = 2022, output = "wide", geometry = T)
MI_2022 <- get_acs(geography="county", variables = acsVariables,
state = "MI", survey = "acs5", year = 2022, output = "wide", geometry = T)
# Clean the county names to remove state name and "County"
# Hint: use mutate() with str_remove()
MI_2022 <- MI_2022 %>%
mutate(NAME = str_remove(NAME, " County, Michigan"))
# Clean the county names to remove state name and "County"
# Hint: use mutate() with str_remove()
MI_2022 <- MI_2022 %>%
mutate(NAME = str_remove(NAME, " County, Michigan"))
# Display the first few rows
glimpse(MI_2022)
View(MI_2022)
# Calculate MOE percentage and reliability categories using mutate()
MI_2022$MOE_per <- (med_HH_incM/med_HH_incE)*100
# Calculate MOE percentage and reliability categories using mutate()
MI_2022$MOE_per <- (MI_2022$med_HH_incM/MI_2022$med_HH_incE)*100
MI_2022 <- MI_2022 %>%
mutate(MOE_per = (med_HH_incM/med_HH_incE)*100)
# Choose your state for analysis - assign it to a variable called my_state
my_state <- "Michigan"
# Write your get_acs() code here
acsVariables <- c(med_HH_inc = "B19013_001", totpop = "B01003_001")
MI_2022 <- get_acs(geography="county", variables = acsVariables,
state = "MI", survey = "acs5", year = 2022, output = "wide", geometry = T)
MI_2022 <- get_acs(geography="county", variables = acsVariables,
state = "MI", survey = "acs5", year = 2022, output = "wide", geometry = T)
# Clean the county names to remove state name and "County"
# Hint: use mutate() with str_remove()
MI_2022 <- MI_2022 %>%
mutate(NAME = str_remove(NAME, " County, Michigan"))
# Clean the county names to remove state name and "County"
# Hint: use mutate() with str_remove()
MI_2022 <- MI_2022 %>%
mutate(NAME = str_remove(NAME, " County, Michigan"))
# Display the first few rows
glimpse(MI_2022)
MI_2022 <- MI_2022 %>%
mutate(MOE_per = (med_HH_incM/med_HH_incE)*100)
View(MI_2022)
# Create a summary showing count of counties in each reliability category
# Hint: use count() and mutate() to add percentages
MI_2022 <- MI_2022 %>%
mutate(reli_cat = case_when(MOE_per < 5 ~ 'High Confidence',
MOE_per > 10 ~ 'Low Confidence',
TRUE ~ 'Moderate Confidence'))
reli_cat_freq <- MI_2022 %>%
count(reli_cat)
View(reli_cat_freq)
reli_cat
reli_cat_freq
print(reli_cat_freq)
# Create table of top 5 counties by MOE percentage
arrange(MI_2022, MOE_per)
# Create table of top 5 counties by MOE percentage
desc(arrange(MI_2022, MOE_per))
# Create table of top 5 counties by MOE percentage
arrange(MI_2022, desc(MOE_per))
library(tidyverse)
library(tidycensus)
library(scales)
library(RColorBrewer)
# Set your Census API key if you haven't already
census_api_key(Sys.getenv("eb283fc5f20283cf588e1f363afe8bc73cf9c354"))
# We'll use Pennsylvania data for consistency with previous weeks
state_choice <- "PA"
# Load all available variables for ACS 5-year 2022
acs_vars_2022 <- load_variables(2022, "acs5", cache = TRUE)
# Load all available variables for ACS 5-year 2022
acs_vars_2022 <- load_variables(2022, "acs5", cache = TRUE)
# Look at the structure
glimpse(acs_vars_2022)
head(acs_vars_2022)
# Search for median age
age_vars <- acs_vars_2022 %>%
filter(str_detect(label, "[Mm]edian.*age"))
View(age_vars)
age_vars
# Common patterns to remember:
common_variables <- tribble(
~concept, ~typical_code, ~description,
"Total Population", "B01003_001", "Total population",
"Median Age", "B01002_001", "Median age of population",
"Median HH Income", "B19013_001", "Median household income",
"White Population", "B03002_003", "White alone population",
"Black Population", "B03002_004", "Black/African American alone",
"Hispanic Population", "B03002_012", "Hispanic or Latino population",
"Bachelor's Degree", "B15003_022", "Bachelor's degree or higher",
"Median Rent", "B25058_001", "Median contract rent",
"Median Home Value", "B25077_001", "Median value owner-occupied"
)
print("Common Census Variables:")
common_variables
state_choice
ggplot(county_data) +
aes(x = total_popE) +
geom_histogram(bins = 15, fill = "lightgreen", alpha = 0.7) +
labs(
title = "Distribution of Total Population",
x = "",
y = "Number of Counties"
) +
theme_minimal() +
scale_x_continuous(labels = dollar)
# Get county-level data for your state
county_data <- get_acs(
geography = "county",
variables = c(
total_pop = "B01003_001",       # Total population
median_income = "B19013_001",   # Median household income
median_age = "B01002_001"       # Median age
),
state = state_choice,
year = 2022,
output = "wide"
)
# Clean county names
county_data <- county_data %>%
mutate(county_name = str_remove(NAME, paste0(", ", state_choice)))
# Basic inspection
glimpse(county_data)
ggplot(county_data) +
aes(x = total_popE) +
geom_histogram(bins = 15, fill = "lightgreen", alpha = 0.7) +
labs(
title = "Distribution of Total Population",
x = "",
y = "Number of Counties"
) +
theme_minimal() +
scale_x_continuous(labels = dollar)
ggplot(county_data) +
aes(x = total_popE) +
geom_histogram(bins = 15, fill = "lightgreen", alpha = 0.7) +
labs(
title = "Distribution of Total Population",
x = "Number of People",
y = "Number of Counties"
) +
theme_minimal() +
scale_x_continuous(labels = dollar)
ggplot(county_data) +
aes(x = total_popE) +
geom_histogram(bins = 15, fill = "lightgreen", alpha = 0.7) +
labs(
title = "Distribution of Total Population",
x = "Number of People",
y = "Number of Counties"
) +
theme_minimal() +
scale_x_continuous()
# Box plot to see outliers clearly
ggplot(county_data) +
aes(y = median_incomeE) +
geom_boxplot(fill = "lightblue", width = 0.5) +
labs(
title = "Median Income Distribution with Outliers",
y = "Median Household Income ($)"
) +
theme_minimal() +
scale_y_continuous(labels = dollar)
ggplot(county_data) +
aes(y = total_popE) +
geom_boxplot(fill = "lightgreen", width = 0.5) +
labs(
title = "Total Population Distrbution and Outliers",
y = "Population"
) +
theme_minimal() +
scale_y_continuous()
pop_outliers <- county_data %>%
mutate(
Q1 = quantile(total_popE, 0.25, na.rm = TRUE),
Q3 = quantile(total_popE, 0.75, na.rm = TRUE),
IQR = Q3 - Q1,
outlier = total_popE < (Q1 - 1.5 * IQR) | total_popE > (Q3 + 1.5 * IQR)
) %>%
filter(outlier) %>%
select(county_name, total_popE)
print("Outlier counties:")
pop_outliers
